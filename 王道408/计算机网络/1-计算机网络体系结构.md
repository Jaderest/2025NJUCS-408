# 第一章 计算机网络体系结构

## 目录
- [第一章 计算机网络体系结构](#第一章-计算机网络体系结构)
  - [目录](#目录)
  - [1.1 计算机网络概述](#11-计算机网络概述)
    - [1.1.1 计算机网络的概念](#111-计算机网络的概念)
    - [1.1.2 计算机网络的组成](#112-计算机网络的组成)
      - [从组成部分上看](#从组成部分上看)
      - [从工作方式](#从工作方式)
      - [从功能组成](#从功能组成)
    - [1.1.3 计算机网络的功能](#113-计算机网络的功能)
    - [1.1.4 电路交换、报文交换与分组交换](#114-电路交换报文交换与分组交换)
      - [电路交换](#电路交换)
      - [报文交换（考：存储转发、数据传送时间的计算）](#报文交换考存储转发数据传送时间的计算)
      - [分组交换](#分组交换)
    - [1.1.5 计算机网络的分类](#115-计算机网络的分类)
      - [按分布范围分类](#按分布范围分类)
      - [按拓扑结构分类](#按拓扑结构分类)
      - [按使用者分类](#按使用者分类)
      - [传输介质分类](#传输介质分类)
    - [1.1.6 计算机网络的性能指标](#116-计算机网络的性能指标)
    - [考点\&易错点](#考点易错点)

## 1.1 计算机网络概述

### 1.1.1 计算机网络的概念
- 计算机网络是一个 将众多分散的、自治的计算机系统 通过通信设备与线路**连接**起来，由功能完善的软件实现资源共享和信息传递的 **系统**。
- 计算机网络（简称网络）由如下组成：
  - 若干节点（Node）
    - 可以是计算机、集线器、交换机、路由器等
  - 连接节点的链路（Link）
- 网络之间还可以通过路由器互联，构成一个覆盖范围更广的计算机网络
  - 称为互联网(**internet**) （小写的 i）
- 理解：**网络**把许多**计算机**连在一起，**互联网**把许多**网络**通过路由器连在一起
- 区别**internet**和**Internet**：
  - **internet**：互联网
    - 通用名词，泛指由多个计算机网络互连而成的计算机网络
    - 这些网络之间可以使用任意协议作为通信规则
    - 不一定要TCP/IP
  - **Internet**：专用名词，指当前全球最大的、开放的、由众多网络和路由器互连而成的特定计算机网络
    - 采用TCP/IP族作为通信规则

### 1.1.2 计算机网络的组成
计算机网络的组成可以分为如下几类：

#### 从组成部分上看
- 由硬件、软件、协议三大部分组成
- 硬件
  - 主机（端系统）
  - 通信链路（如双绞线、光纤）
  - 交换设备（如路由器、交换机等）
  - 通信处理机（如网卡）等组成
- 软件
  - 主要包括各种实现资源共享的软件和方便用户使用的各种工具软件
  - E-mail、FTP、聊天程序
- 协议
  - 计算机网络的核心
  - 如同交规制约汽车驾驶

#### 从工作方式
- 计算机网络（Internet）可分为边缘部分和核心部分
- 边缘部分
  - 所有连接到互联网上的供用户直接使用的主机组成
  - 用来进行通信（如传输数据、音频或视频）&资源共享
- 核心部分
  - 由大量网络和连接这些网络的路由器
  - 为边缘部分提供连通性和交换服务

#### 从功能组成
- 计算机网络由通信子网和资源子网两部分组成
- 通信子网
  - 各种传输介质、通信设备和相应网络协议组成
  - 使网络有具有数据传输、交换、控制和存储的能力
  - 实现互联网计算机之间的数据通信
- 资源子网
  - 实现资源共享功能的设备及其软件的集合
  - 向网络用户提供其他计算机上的硬件资源、软件资源和数据资源的服务

### 1.1.3 计算机网络的功能
五大功能：
1. 数据通信
2. 资源共享
3. 分布式处理
4. 提高可靠性——互为体态机
5. 负载均衡

### 1.1.4 电路交换、报文交换与分组交换
网络核心起重要作用的是**路由器**（Router），对收到的分组进行存储转发实现分组交换

#### 电路交换
- **交换**就是按某种方式动态分配传输线路的资源
- 电路交换分为三步
  - 建立连接（开始占用通信资源）
    - 数据传输前，两个用户之间必须建立一条**专用的物理通信路径**（双方交换设备和链路逐段连接而成）
  - 传输数据（一直占用通信资源）
    - 传输数据过程中，物理通信路径从始至终被两个用户**独占**，直到通信结束才释放
  - 释放连接（归还通信资源）
- 除源节点和目的节点外，电路上其他任何节点都采取“直通方式”发送和传输，**不存在存储转发**
- 优点
  - 通信时延小：双方专用，数据直达，传输效率高
  - 有序传输：按顺序传送数据，不存在失序问题
  - 没有冲突：不同的通信双方之间拥有不同的信道，不会争用物理信道
  - 实时性强：物理通路建立后可随时通信
- 缺点：
  - 建立连接时间长：需要建立专用的物理通信路径
  - 线路利用率低：线路一直占用，空闲了也不能给其他用户使用
  - 灵活性差：通路中任何一点出现故障，都得重新建立连接
  - 难以实现差错控制：中间节点不具备存储和检验数据的能力

#### 报文交换（考：存储转发、数据传送时间的计算）
- 数据交换的单位是**报文**（Message）
  - 用户数据加上源地址、目的地址等信息后，封装成报文
- 报文交换采用**存储转发技术**
  - 报文传送到相邻节点，全部存储后查找转发表，转发到下一个节点，直到达到目的节点
  - 每个报文都可以单独选择到达目的端的路径
- 报文交换技术的优先
  - 无建立连接时延——用户可随时发报文
  - 灵活分配线路——交换节点存储整个报文后，选择一条合适的空闲线路转发，若某条路径故障，则可选择另一条路径传输数据
  - 线路利用率高——传送时才占用通信资源
  - 支持差错控制——中间节点具备存储和检验数据的能力

#### 分组交换
- 分组交换也采用**存储转发技术**
- 源主机发送前，将较长的报文划分成若干较小的等长数据段，每个数据段前面添加一些由必要控制信息（如源地址、目的地址和编号信息等）组成的首部，形成**分组**（Packet）
- 源主机将分组发送到分组交换网中，分组交换网中的分组交换机收到一个分组后，将其**缓存**，**从首部提取**目的地址，据此查找自己的**转发表**，发给下一个分组交换机，最终达到目标主机
- 除继承报文交换诸多优点，还有如下优点：
  - 方便存储管理，存储转发开销小——分组长度固定，缓冲区大小也固定
  - 传输效率高——后一个分组的存储与前一个分组的转发操作并行，**流水线方式**减少了报文传输时间
  - 减少出错概率和重传代价——分组段，出错概率必然减小
- 缺点：
  - 存在存储转发时延
  - 需要传输额外的信息量
  - 失序、丢失、重复分组情况

### 1.1.5 计算机网络的分类

#### 按分布范围分类
1. 广域网（WAN）
   - 长距离通信，直径几十米~几千千米
   - 互联网核心部分
   - 连接各节点交换机的链路一般都是高速链路，较大通信容量
2. 城域网（MAN）
   - 几个街区甚至整个城市，直径5~50km
   - 大多以太网技术（有时划入局域网范围讨论）
3. 局域网（LAN）
   - 用主机通过高速线路相连，覆盖范围较小
   - 直径几米~几千米
   - 传统上，**局域网使用广播技术**，广域网使用交换技术
4. 个人局域网（PAN）
   - 个人工作地方将消费电子设备（如平板、手机）用无线技术连接起来的网络
   - 也叫无线个人局域网（WPAN）

#### 按拓扑结构分类
- 分为总线形、星形、环形、网状形等
- 星形、总线形、环形网络多用于局域网、网状网络多用于广域网
- 总线形网络
  - 单根传输线连接计算机
  - 优点
    - 建网容易
    - 增减节点方便
    - 节省线路
  - 缺点
    - 重负载时通信效率不高
    - 对故障敏感
- 星形网络
  - 每个终端/计算机以单独线路连接中央设备，中央设备一般是交换机或路由器
  - 优点
    - 便于集中控制和管理
  - 缺点
    - 成本高
    - 中央设备对故障敏感
- 环状网络
  - 所有计算机接口设备连接成一个环，最典型例子是令牌环局域网
  - 环可以是单环或双环
  - 环中信号单向传输
- 网状网络
  - 每条节点至少两条路径与其他节点相连
  - 分为规则型和非规则型
  - 优点
    - 可靠性高
  - 缺点
    - 控制复杂
    - 线路成本高

#### 按使用者分类
1. 公用网
2. 专用网

#### 传输介质分类
- 有线网
  - 双绞线网络
  - 同轴电缆网络
- 无线网
  - 蓝牙
  - 微波
  - 无线电等类型

### 1.1.6 计算机网络的性能指标
- 常用性能指标如下
  - 速率（Speed，数据传输速率、数据率、比特率）
    - 指单位时间内传输的数据量
    - 单位：b/s, bit/s, bps, kb/s, Mb/s, Gbps
  - 带宽（Bandwidth）
    - 数字信道所能传送的“最高数据传输速率”的同义语，b/s
  - 吞吐量（Throughput）（考：吞吐量的分析）
    - 指单位时间内通过某个网络（or信道or接口）的实际数据量
  - 时延（Delay）
    - 指数据从源主机发送到目的主机所需的时间
    - 包括发送时延、传播时延、排队时延和处理时延
  - 时延带宽积（Delay-Bandwidth Product）
    - 发送第一个比特即将到达终点时，发送端已发送多少比特
    - 反映了网络中可以同时传输的数据量
    - 计算公式：时延带宽积 = 时延 × 带宽
  - 往返时延（Round Trip Time, RTT）
    - 指从源主机发送一个分组到目的主机，并收到目的主机的确认分组所需的时间
    - 包括各中间节点的处理时延、排队时延和传播时延
  - 信道利用率
    - 某个信道有百分之多少时间是有数据通过的
    - 信道利用率 = 有数据传输的时间 / 总时间
    - **如果利用率太高反而会产生较大时延，导致网络拥塞**
- 分组交换网中各种时延的计算
  - 发送时延（也叫传播时延）
    - 发送分组第一个比特到分组最后一个比特发送完毕所用时间
    - 发送时延 = 分组长度 / 发送速率
  - 传播时延
    - 传输介质中传播一定距离所花时间
    - 传播时延 = 信道物理长度 / 电磁波在信道上的传播速度
  - 处理时延
    - 分组在交换节点为存储转发进行的一些必要处理所花时间
    - 分析分组首部、差错检验、查找合适路由
  - 排队时延
    - 分组在路由器输入/输出队列中排队等待所花时间
  - 总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延

### 考点&易错点

- 分组传输中：分组大小1000B，分组头大小20B -> 分组携带的数据大小为980B

- **小心1000B和1Mb/s中单位的区别**

- **分组交换的计算**
  - 可以看作流水线，为了方便，假设各流水段时间相同设为r
  - 两主机通信，中间k段链路
  - 传输m各分组用时 t = k*r + (m-1)*r
    - k*r：第一个分组从源主机到目的主机的时间
    - (m-1)*r：后续分组的传输时间